name: Test Project
on: [push, workflow_dispatch] # this means we can trigger this workflow with push and manually on github dashboard
jobs: # By default, jobs run in parallel
    test:
        runs-on: ubuntu-latest
        steps:
          - name: Get code # WE want to get the code into our ubuntu environment
            uses: actions/checkout@v4

          # ubuntu already has node js installed. so no need to reinstall it.
          # else if you application relies on another package which is not pre installed you'll need to install it
          - name: Install Node Js
            uses: actions/setup-node@v4
            with:
              node-version: 20

          - name: Install dependencies
            working-directory: ./02 Starting Project # optional if .github/ is in same directory level as the project
            run: npm ci # ci meaning use same packages in the packages-lock.json. However you could simply do `npm install`
          
          
          - name: Run our Tests on the runner
            working-directory: ./02 Starting Project
            run: npm test
    
    deploy:
      needs: test # this says that deploy should only run after test is done successfully. you can also do for multiple job dependants [test, integration]
      runs-on: ubuntu-latest # every job has its own runner different from the runner of other jobs
      steps:
          - name: Get code
            uses: actions/checkout@v4

          - name: Install Node Js
            uses: actions/setup-node@v4
            with:
              node-version: 20

          - name: Install dependencies
            working-directory: ./02 Starting Project
            run: npm install

          - name: Build project
            working-directory: ./02 Starting Project
            run: npm run build

          - name: Deploy
            working-directory: ./02 Starting Project
            run: echo "Deploying..."

